var isFloatBtnDragging=0;class FloatBtnMenu{options={enabled:!0,btnId:"floatBtn",containerId:"floatBtnContainer"};constructor(e){e&&Object.keys(e).length>0&&(this.options=Object.assign(this.options,e)),this.init(),this.formHtml=`
    <div class="layui-form layui-form-pane" lay-filter="filter-test-layer" style="margin: 16px;">
      <form class="layui-form" id="configMenu" lay-filter="config-menu-layer" action="">
        <div class="layui-col-xs6 layui-col-md6">
          <div class="layui-form-item">
            <label class="layui-form-label">鼠标爱心</label>
            <div class="layui-input-block">
              <input type="radio" lay-filter="mouseHeart-radio" id="mouseHeart-radio-close" name="mouseHeart" value="0" title="关" checked>
              <input type="radio" lay-filter="mouseHeart-radio" id="mouseHeart-radio-on" name="mouseHeart" value="1" title="开">
            </div>
          </div>
        </div>
        <div class="layui-col-xs6 layui-col-md6">
          <div class="layui-form-item">
            <label class="layui-form-label">鼠标尾巴</label>
            <div class="layui-input-block">
              <input type="radio" lay-filter="mouseTail-radio" id="mouseTail-radio-close" name="mouseTail" value="0" title="关" checked>
              <input type="radio" lay-filter="mouseTail-radio" id="mouseTail-radio-on" name="mouseTail" value="1" title="开">
            </div>
          </div>
        </div>
        <div class="layui-col-xs6 layui-col-md6">
          <div class="layui-form-item">
            <label class="layui-form-label">鼠标烟花</label>
            <div class="layui-input-block">
              <input type="radio" lay-filter="firework-radio" id="firework-radio-close" name="firework" value="0" title="关" checked>
              <input type="radio" lay-filter="firework-radio" id="firework-radio-on" name="firework" value="1" title="开">
            </div>
          </div>
        </div>
        <div class="layui-col-xs6 layui-col-md6">
          <div class="layui-form-item">
             <label class="layui-form-label">看板娘模型</label>
             <div class="layui-input-block">
                <select id="live2dModelSelect" name="live2dModel" lay-verify="required" lay-search >
                  <option value="">直接选择或搜索选择</option>
                  <option value="0" selected>Diana</option>
                  <option value="1">Ava</option>
                  <option value="2">小云</option>
                </select>
              </div>
            </div>
        </div>
        <div class="layui-col-xs6 layui-col-md12">
          <div class="layui-form-item">
            <label class="layui-form-label">看板娘</label>
            <div class="layui-input-block">
              <input type="radio" lay-filter="live2d-radio-filter" name="live2d" value="0" title="隐藏" checked>
              <input type="radio" lay-filter="live2d-radio-filter" name="live2d" value="1" title="显示">
              <input type="radio" lay-filter="live2d-radio-filter" name="live2d" value="2" title="关闭">
            </div>
          </div>
        </div>
        <div class="layui-col-xs6 layui-col-md12">
          <div class="layui-form-item">
            <label class="layui-form-label">主题</label>
            <div class="layui-input-block">
              <input type="radio" name="theme" value="0" title="白天" checked>
              <input type="radio" name="theme" value="1" title="夜间">
              <input type="radio" name="theme" value="2" title="跟随系统">
            </div>
          </div>
        </div>
        <div class="layui-form-item layui-text-center">
          <button type="submit" class="layui-btn" lay-submit lay-filter="save-config">保存</button>
          <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </form>
  </div>
    `}init(){this.options.enabled&&(this.createElement(),this.initFloatBtnEvent(),this.initMenuInfo())}createElement(){let e=document.createElement("div");e.id=this.options.containerId,e.classList.add("layui-btn-container"),e.style.cssText="z-index: 999999; position: fixed; bottom: 20px; width: 60px; height: 60px;";let i=document.createElement("img");i.src="https://cdn.jsdelivr.net/gh/jtcymc/ymc_typora@0.0.4/dist/assets/setting.png",e.appendChild(i),document.body.appendChild(e);let t="";t+=`
    <div id='ss_menu'>
    <div>
      <i class="fa fa-qq"></i>
    </div>
    <div>
      <i class="fa fa-weibo"></i>
    </div>
    <div>
      <i class="fa fa-weixin"></i>
    </div>
    <div>
      <i class="fa fa-renren"></i>
    </div>
    <div class='menu'>
      <div class='share' id='ss_toggle' data-rot='180'>
        <div class='circle'></div>
        <div class='bar'></div>
      </div>
    </div>
  </div>     
`}buttonsClick(e,i){}initMenuInfo(){var e=layui.$,i=layui.layer,t=layui.form;let l=document.getElementById(this.options.containerId);l.onclick=()=>{if(1==isFloatBtnDragging)return;isFloatBtnDragging=2;let l=i.open({type:1,area:["650px","350px"],resize:!0,shadeClose:!0,title:"组件配置",content:this.formHtml,success:function(){t.render();let o=JSON.parse(localStorage.getItem("configMenu")),a=o&&Object.keys(o).length>0,s=localStorage.getItem("darkModel")||0,n=localStorage.getItem("syncSysThemeMode")||0;s=n&&0!=n?2:s;let d=0==sessionStorage.getItem("posterGirl")?0:1;d=0==localStorage.getItem("showLive2d")?2:d;let r=localStorage.getItem("live2dModel");var u=null;(u=o&&Object.keys(o).length>0?t.val("config-menu-layer",{mouseHeart:o.mouseHeart||0,mouseTail:o.mouseTail||0,firework:o.firework||0,live2dModel:r||0,live2d:d,theme:s||0}):t.val("config-menu-layer",{mouseHeart:0,mouseTail:0,firework:0,live2dModel:r||0,live2d:d,theme:s||0}))?.mouseHeart&&1==u.mouseHeart?e("#firework-radio-on").prop("disabled",!0):e("#firework-radio-on").prop("disabled",!1),t.render("select"),u?.firework&&1==u.firework?e("#mouseHeart-radio-on").prop("disabled",!0):e("#mouseHeart-radio-on").prop("disabled",!1),u?.live2d&&1==u.live2d?e("#live2dModelSelect").prop("disabled",!1):e("#live2dModelSelect").prop("disabled",!0),t.render("radio"),t.on("radio(live2d-radio-filter)",function(i){1==i.elem.value?e("#live2dModelSelect").prop("disabled",!1):e("#live2dModelSelect").prop("disabled",!0),t.render("select")}),t.on("radio(mouseHeart-radio)",function(i){1==i.elem.value?(e("#firework-radio-on").prop("disabled",!0),e("#firework-radio-close").prop("checked",!0)):e("#firework-radio-on").prop("disabled",!1),t.render("radio")}),t.on("radio(firework-radio)",function(i){1==i.elem.value?(e("#mouseHeart-radio-on").prop("disabled",!0),e("#mouseHeart-radio-close").prop("checked",!0)):e("#mouseHeart-radio-on").prop("disabled",!1),t.render("radio")}),t.on("submit(save-config)",function(e){var t=e.field;return t&&localStorage.setItem("configMenu",JSON.stringify(t)),a&&o.mouseHeart==t.mouseHeart||(1==t.mouseHeart?window?.ymcEventBus.emit("onMouseHeart"):window?.ymcEventBus.emit("removeMouseHeart")),a&&o.firework==t.firework||(1==t.firework?window?.ymcEventBus.emit("onFirework"):window?.ymcEventBus.emit("removeFirework")),a&&o.mouseTail==t.mouseTail||(1==t.mouseTail?window?.ymcEventBus.emit("onMouseTail"):window?.ymcEventBus.emit("removeMouseTail")),a&&o.live2d==t.live2d||(1==t.live2d?window?.ymcEventBus.emit("onLive2d",t.live2dModel):0==t.live2d?window?.ymcEventBus.emit("removeLive2d"):2==t.live2d&&window?.ymcEventBus.emit("stopLive2d")),a&&o.theme==t.theme&&(2!=t.theme||1!=n)||(2==t.theme?window?.ymcEventBus.emit("syncSysTheme"):window?.ymcEventBus.emit("changeTheme",t.theme)),1==t.live2d&&o.live2dModel!=t.live2dModel&&1==o.live2d&&window?.ymcEventBus.emit("changeLive2dModel",t.live2dModel),i.msg("保存成功",{icon:1,time:2e3},function(){i.close(l)}),isFloatBtnDragging=0,!1})},end:function(){isFloatBtnDragging=0}})}}initFloatBtnEvent(){let e=document.getElementById(this.options.containerId);e&&(e.addEventListener("mousedown",function i(t){var l={x:t.clientX-this.offsetLeft,y:t.clientY-this.offsetTop};function o(i){if(i.preventDefault(),2!=isFloatBtnDragging){isFloatBtnDragging=1;let t=i.clientX-l.x;t<0?t=0:t>=window.innerWidth-e.offsetWidth&&(t=window.innerWidth-e.offsetWidth),e.style.left=t+"px",e.style.top=i.clientY-l.y+"px",e.style.bottom="auto"}}function a(i){1==isFloatBtnDragging&&(e.offsetTop+e.clientHeight>=window.innerHeight?e.style.top=window.innerHeight-e.clientHeight+"px":e.offsetTop<=20?e.style.top="10px":e.style.top=e.offsetTop+"px"),e.removeEventListener("mousemove",o),e.removeEventListener("mouseup",a)}isFloatBtnDragging=0,e.addEventListener("mousemove",o),e.addEventListener("mouseup",a)}),e.addEventListener("mouseover",function(){e.style.opacity=1}),e.addEventListener("mouseout",function(){e.style.opacity=.75}),window.addEventListener("resize",function(){e.style.left="5px",e.style.bottom="40px"}))}}
